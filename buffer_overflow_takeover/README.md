# Buffer overflow takeover

Here we overflow accessing an array on the stack and overwrite the return address to take over the program.

 - [main.c on Netrun](https://lawlor.cs.uaf.edu/netrun/run?name=example_c&code=%23include%3Cstdio.h%3E%0D%0A%23include%3Cstdlib.h%3E%0D%0A%0D%0Aextern%20long%20count_a%28const%20char%2A%29%3B%0D%0A%0D%0A%2F%2F%20foo%20is%20a%20harmless%20function%20that%20sums%20up%20an%20array%20with%20some%20user%20input%0D%0Along%20foo%28%29%20%7B%0D%0A%20%20long%20arr%5B8%5D%20%3D%20%7B%201%2C%202%2C%203%2C%204%2C%205%2C%206%2C%207%2C%208%20%7D%3B%0D%0A%20%20long%20x%20%3D%200%2C%20y%20%3D%200%3B%0D%0A%20%20printf%28%22I%20have%20an%20array%3A%20%5B1%2C%202%2C%203%2C%204%2C%205%2C%206%2C%207%2C%208%5D%5Cn%22%29%3B%0D%0A%20%20printf%28%22enter%20which%20number%20to%20replace%3A%5Cn%22%29%3B%0D%0A%20%20if%281%20%21%3D%20scanf%28%22%25ld%22%2C%20%26x%29%29%20exit%281%29%3B%0D%0A%20%20printf%28%22enter%20what%20to%20replace%20it%20with%3A%5Cn%22%29%3B%0D%0A%20%20if%281%20%21%3D%20scanf%28%22%25ld%22%2C%20%26y%29%29%20exit%281%29%3B%0D%0A%20%20arr%5Bx%5D%20%3D%20y%3B%0D%0A%20%20long%20acc%20%3D%200%3B%0D%0A%20%20printf%28%22x%3A%20%25ld%2C%20y%3A%20%25ld%2C%20acc%3A%20%25ld%5Cn%22%2C%20x%2C%20y%2C%20acc%29%3B%0D%0A%20%20for%28int%20i%20%3D%200%3B%20i%20%3C%208%3B%20%2B%2Bi%29%20%7B%0D%0A%20%20%20acc%20%2B%3D%20arr%5Bi%5D%3B%0D%0A%20%20%7D%0D%0A%20%20return%20acc%3B%0D%0A%7D%0D%0A%0D%0A%2F%2F%20something%20we%20definitely%20don%27t%20want%20to%20execute%0D%0Avoid%20evilfunc%28%29%20%7B%0D%0A%20%20puts%28%22Ahahahah%20I%20have%20control%21%22%29%3B%0D%0A%20%20exit%281%29%3B%0D%0A%20%20return%3B%0D%0A%7D%0D%0A%0D%0Aint%20main%28%29%20%7B%0D%0A%20%20long%20ptr%20%3D%20%28long%29%20evilfunc%3B%0D%0A%20%20printf%28%22the%20address%20of%20evilfunc%20is%3A%20%25ld%5Cn%22%2C%20ptr%29%3B%0D%0A%20%20printf%28%22the%20stack%20in%20foo%20looks%20like%3A%5Cn%5Ctarr%3A%5Ct1%5Cn%5Ct%5Ct2%5Cn%5Ct%5Ct3%5Cn%5Ct%5Ct4%5Cn%5Ct%5Ct5%5Cn%5Ct%5Ct6%5Cn%5Ct%5Ct7%5Cn%5Ct%5Ct8%5Cn%5Ct%5Ct%3F%5Cn%5Ct%5Ct%3F%5Cn%5Ct%5Ct%3F%5Cn%5Ctreturn%3A%5Ctmain%5Cn%22%29%3B%0D%0A%20%20printf%28%22if%20you%20access%20the%2011th%20element%20of%20the%20array%20it%20writes%20to%20the%20return%20address%21%5Cn%22%29%3B%0D%0A%20%20printf%28%22try%20writing%20the%20address%20of%20evilfunc%20and%20see%20what%20happens%5Cn%22%29%3B%0D%0A%20%20printf%28%22your%20result%20was%3A%20%25ld%22%2C%20foo%28%29%29%3B%0D%0A%20%20return%200%3B%0D%0A%7D&lang=C&mach=skylake64&mode=main&input=11%0D%0A4195959&check_input=Input&linkwith=&foo_ret=long&foo_arg0=void&orun=Run&orun=Grade&ocompile=Optimize&ocompile=Warnings)
